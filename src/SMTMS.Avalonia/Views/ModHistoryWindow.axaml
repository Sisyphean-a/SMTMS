<Window
    Height="600"
    Title="æ¨¡ç»„åŽ†å²è®°å½•"
    Width="900"
    WindowStartupLocation="CenterOwner"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="SMTMS.Avalonia.Views.ModHistoryWindow"
    x:DataType="vm:ModHistoryViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:SMTMS.Avalonia.ViewModels"
    xmlns:cv="using:SMTMS.Avalonia.Converters"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Window.Resources>
        <cv:BoolNegationConverter x:Key="BoolNegationConverter"/>
    </Window.Resources>

    <Grid Margin="15" RowDefinitions="*, Auto">
        <!--  History List  -->
        <Panel Grid.Row="0">
            <!-- Empty State -->
            <StackPanel
                HorizontalAlignment="Center"
                IsVisible="{Binding HasHistory, Converter={StaticResource BoolNegationConverter}}"
                Spacing="20"
                VerticalAlignment="Center">
                <TextBlock
                    FontSize="48"
                    HorizontalAlignment="Center"
                    Text="ðŸƒ" />
                <StackPanel Spacing="10">
                    <TextBlock
                        FontWeight="Bold"
                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                        HorizontalAlignment="Center"
                        Text="æ— åŽ†å²è®°å½•" />
                    <TextBlock
                        FontSize="12"
                        Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}"
                        HorizontalAlignment="Center"
                        Text="è¯¥æ¨¡ç»„å°šæœªè¿›è¡Œè¿‡ä»»ä½•åŒæ­¥" />
                </StackPanel>
            </StackPanel>

            <DataGrid
                AutoGenerateColumns="False"
                BorderBrush="#E1E3E6"
                BorderThickness="1"
                GridLinesVisibility="Horizontal"
                HeadersVisibility="Column"
                IsReadOnly="True"
                IsVisible="{Binding HasHistory}"
                ItemsSource="{Binding HistoryItems}"
                RowBackground="Transparent"
                SelectedItem="{Binding SelectedHistoryItem}">
                <DataGrid.Styles>
                    <Style Selector="DataGridColumnHeader">
                        <Setter Property="Background" Value="#FAFAFA" />
                        <Setter Property="Foreground" Value="#999999" />
                        <Setter Property="FontSize" Value="11" />
                    </Style>
                </DataGrid.Styles>
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Binding="{Binding SnapshotTime}"
                        FontFamily="{StaticResource MonoFont}"
                        Header="å¿«ç…§æ—¶é—´"
                        Width="180" />
                    <DataGridTextColumn
                        Binding="{Binding DisplayName}"
                        Header="åç§°"
                        Width="*" />
                    <DataGridTextColumn
                        Binding="{Binding DisplayDescription}"
                        Header="æè¿°"
                        Width="2*" />
                    <DataGridTextColumn
                        Binding="{Binding DisplayAuthor}"
                        Header="ä½œè€…"
                        Width="120" />
                    <DataGridTextColumn
                        Binding="{Binding DisplayVersion}"
                        FontFamily="{StaticResource MonoFont}"
                        Header="ç‰ˆæœ¬"
                        Width="100" />
                </DataGrid.Columns>
            </DataGrid>
        </Panel>

        <!--  Bottom Actions  -->
        <StackPanel
            Grid.Row="1"
            HorizontalAlignment="Right"
            Margin="0,20,0,0"
            Orientation="Horizontal"
            Spacing="15">
            <TextBlock
                FontFamily="{StaticResource MonoFont}"
                FontSize="11"
                Foreground="#999999"
                Text="[è¯·é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ä»¥æ¢å¤å…ƒæ•°æ®]"
                VerticalAlignment="Center" />
            <Button Command="{Binding CloseCommand}" Content="å…³é—­" Classes="Tertiary"/>
            <Button
                Classes="Solid"
                Command="{Binding ApplyCommand}"
                Content="åº”ç”¨é€‰ä¸­ç‰ˆæœ¬"
                IsEnabled="{Binding SelectedHistoryItem, Converter={x:Static ObjectConverters.IsNotNull}}" />
        </StackPanel>

        <!--  Loading Overlay  -->
        <Border
            Background="#EEFFFFFF"
            Grid.Row="0"
            Grid.RowSpan="2"
            IsVisible="{Binding IsLoading}">
            <TextBlock
                FontFamily="{StaticResource MonoFont}"
                FontSize="20"
                Foreground="{StaticResource GeekBlueBrush}"
                HorizontalAlignment="Center"
                Text="[æ­£åœ¨èŽ·å–åŽ†å²è®°å½•...]"
                VerticalAlignment="Center" />
        </Border>
    </Grid>
</Window>
