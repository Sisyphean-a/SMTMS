<Window x:Class="SMTMS.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SMTMS.UI"
        mc:Ignorable="d"
        Title="{Binding ApplicationTitle}" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="10">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="扫描模组" Command="{Binding LoadModsCommand}" Margin="0,0,10,0" Padding="10,5" ToolTip="重新加载模组列表。"/>
                <TextBox Text="{Binding ModsDirectory}" Width="400" VerticalContentAlignment="Center" ToolTip="模组目录路径。"/>
                <Button Content="浏览..." Command="{Binding BrowseFolderCommand}" Margin="5,0,0,0" Padding="10,5" ToolTip="选择模组目录。"/>
            </StackPanel>
            
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Button Content="同步到数据库" Command="{Binding SyncToDatabaseCommand}" Margin="0,0,10,0" Padding="10,5" Background="#9C27B0" Foreground="White" BorderThickness="0" ToolTip="扫描本地模组，将中文翻译保存到数据库。"/>
                <Button Content="从数据库恢复" Command="{Binding RestoreFromDatabaseCommand}" Margin="0,0,10,0" Padding="10,5" Background="#4CAF50" Foreground="White" BorderThickness="0" ToolTip="从数据库读取翻译并应用到本地文件。"/>
                <Button Content="初始化(测试用)" Command="{Binding HardResetCommand}" Margin="0,0,10,0" Padding="10,5" Background="#607D8B" Foreground="White" BorderThickness="0" ToolTip="清空所有数据和历史，重置为初始状态。"/>
            </StackPanel>
            
            <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" Foreground="Gray"/>
        </StackPanel>

        <TabControl Grid.Row="1" Margin="10">
            <TabItem Header="模组列表">
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <DataGrid Grid.Column="0" ItemsSource="{Binding Mods}" SelectedItem="{Binding SelectedMod}" AutoGenerateColumns="False" IsReadOnly="True" BorderThickness="1" BorderBrush="LightGray">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="状态" Binding="{Binding TranslationStatus}" Width="180" Foreground="Red"/>
                            <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="作者" Binding="{Binding Author}" Width="150"/>
                            <DataGridTextColumn Header="版本" Binding="{Binding Version}" Width="80"/>
                            <DataGridTextColumn Header="ID" Binding="{Binding UniqueID}" Width="200"/>
                            <DataGridTextColumn Header="描述" Binding="{Binding Description}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent" ShowsPreview="True"/>

                    <Border Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="3" Padding="15" Background="White">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedMod}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Hidden"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <TextBlock Text="编辑模组详情" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                                <TextBlock Text="名称" FontWeight="Medium" Foreground="DimGray"/>
                                <TextBox x:Name="NameTextBox" Text="{Binding SelectedMod.Name, UpdateSourceTrigger=Explicit}" Margin="0,5,0,15" Padding="5"/>

                                <TextBlock Text="作者" FontWeight="Medium" Foreground="DimGray"/>
                                <TextBox x:Name="AuthorTextBox" Text="{Binding SelectedMod.Author, UpdateSourceTrigger=Explicit}" Margin="0,5,0,15" Padding="5"/>

                                <TextBlock Text="版本" FontWeight="Medium" Foreground="DimGray"/>
                                <TextBox x:Name="VersionTextBox" Text="{Binding SelectedMod.Version, UpdateSourceTrigger=Explicit}" Margin="0,5,0,15" Padding="5"/>

                                <TextBlock Text="唯一ID" FontWeight="Medium" Foreground="DimGray"/>
                                <TextBox Text="{Binding SelectedMod.UniqueID, UpdateSourceTrigger=Explicit}" Margin="0,5,0,15" Padding="5" IsReadOnly="True" Background="#F5F5F5" ToolTip="Mod ID cannot be changed safely."/>

                                <TextBlock Text="描述" FontWeight="Medium" Foreground="DimGray"/>
                                <TextBox x:Name="DescriptionTextBox" Text="{Binding SelectedMod.Description, UpdateSourceTrigger=Explicit}" Height="120" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Margin="0,5,0,15" Padding="5"/>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="查看历史" Command="{Binding SelectedMod.ShowHistoryCommand}" Margin="0,0,10,0" Padding="20,8" Background="#673AB7" Foreground="White" BorderThickness="0" Cursor="Hand">
                                        <Button.Resources>
                                            <Style TargetType="Border">
                                                <Setter Property="CornerRadius" Value="3"/>
                                            </Style>
                                        </Button.Resources>
                                    </Button>
                                    <Button Content="保存更改" Command="{Binding SaveModCommand}" Padding="20,8" Background="#007ACC" Foreground="White" BorderThickness="0" Cursor="Hand">
                                        <Button.Resources>
                                            <Style TargetType="Border">
                                                <Setter Property="CornerRadius" Value="3"/>
                                            </Style>
                                        </Button.Resources>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    
                    <TextBlock Grid.Column="2" Text="选择一个模组以编辑详情" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Gray" FontSize="14" FontStyle="Italic">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Hidden"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedMod}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </TabItem>
            
            <TabItem Header="历史记录">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 操作按钮 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="刷新列表" Command="{Binding LoadHistoryCommand}" Margin="0,0,10,0" Padding="10,5" ToolTip="刷新 Git 提交历史列表。"/>
                        <Button Content="回滚到选中" Command="{Binding GitRollbackCommand}" Margin="0,0,10,0" Padding="10,5" Background="#E74C3C" Foreground="White" BorderThickness="0" ToolTip="将文件恢复到选中提交的状态。警告：这是破坏性操作！"/>
                    </StackPanel>

                    <!-- 提交历史列表 -->
                    <DataGrid Grid.Row="1" ItemsSource="{Binding CommitHistory}" SelectedItem="{Binding SelectedCommit}"
                              AutoGenerateColumns="False" IsReadOnly="True" BorderThickness="1" BorderBrush="LightGray"
                              Height="150" Margin="0,0,0,10">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="哈希" Binding="{Binding ShortHash}" Width="70"/>
                            <DataGridTextColumn Header="信息" Binding="{Binding Message}" Width="*"/>
                            <DataGridTextColumn Header="作者" Binding="{Binding Author}" Width="120"/>
                            <DataGridTextColumn Header="日期" Binding="{Binding FormattedDate}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- 变更详情区域 -->
                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="3*"/>
                            <ColumnDefinition Width="5"/>
                            <ColumnDefinition Width="2*"/>
                        </Grid.ColumnDefinitions>

                        <!-- 左侧：变更列表（使用 DataGrid） -->
                        <DataGrid Grid.Column="0" ItemsSource="{Binding ModDiffChanges}" SelectedItem="{Binding SelectedDiffItem}"
                                  AutoGenerateColumns="False" IsReadOnly="True" BorderThickness="1" BorderBrush="LightGray"
                                  HeadersVisibility="Column">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="" Binding="{Binding Icon}" Width="30"/>
                                <DataGridTextColumn Header="模组名称" Binding="{Binding ModName}" Width="200"/>
                                <DataGridTextColumn Header="文件夹" Binding="{Binding FolderName}" Width="150"/>
                                <DataGridTemplateColumn Header="变更内容" Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Margin="5,3">
                                                <!-- 名称变更 -->
                                                <TextBlock Margin="0,2">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding NameChange.HasChange}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                    <Run Text="名称: " FontWeight="SemiBold" Foreground="#673AB7"/>
                                                    <Run Text="{Binding NameChange.ChangeSummary, Mode=OneWay}" Foreground="DimGray"/>
                                                </TextBlock>

                                                <!-- 描述变更 -->
                                                <TextBlock Margin="0,2">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DescriptionChange.HasChange}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                    <Run Text="描述: " FontWeight="SemiBold" Foreground="#673AB7"/>
                                                    <Run Text="{Binding DescriptionChange.ChangeSummary, Mode=OneWay}" Foreground="DimGray"/>
                                                </TextBlock>

                                                <!-- 作者变更 -->
                                                <TextBlock Margin="0,2">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding AuthorChange.HasChange}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                    <Run Text="作者: " FontWeight="SemiBold" Foreground="#673AB7"/>
                                                    <Run Text="{Binding AuthorChange.ChangeSummary, Mode=OneWay}" Foreground="DimGray"/>
                                                </TextBlock>

                                                <!-- 版本变更 -->
                                                <TextBlock Margin="0,2">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding VersionChange.HasChange}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                    <Run Text="版本: " FontWeight="SemiBold" Foreground="#673AB7"/>
                                                    <Run Text="{Binding VersionChange.ChangeSummary, Mode=OneWay}" Foreground="DimGray"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent" ShowsPreview="True"/>

                        <!-- 右侧：详情面板 -->
                        <Border Grid.Column="2" BorderBrush="LightGray" BorderThickness="1" CornerRadius="3" Padding="15" Background="White">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel>
                                    <!-- 未选中状态 -->
                                    <TextBlock Text="← 选择一个模组查看详细变更"
                                              HorizontalAlignment="Center" VerticalAlignment="Center"
                                              Foreground="Gray" FontSize="14" FontStyle="Italic" Margin="0,50,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Hidden"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding SelectedDiffItem}" Value="{x:Null}">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>

                                    <!-- 已选中状态 -->
                                    <StackPanel>
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Setter Property="Visibility" Value="Visible"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding SelectedDiffItem}" Value="{x:Null}">
                                                        <Setter Property="Visibility" Value="Hidden"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </StackPanel.Style>

                                        <!-- 模组基本信息 -->
                                        <TextBlock Text="模组详情" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                                        <Grid Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="模组名称：" FontWeight="Medium" Foreground="DimGray" Margin="0,0,10,8"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedDiffItem.ModName}" TextWrapping="Wrap" Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="唯一ID：" FontWeight="Medium" Foreground="DimGray" Margin="0,0,10,8"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedDiffItem.UniqueID}" TextWrapping="Wrap" Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="文件夹：" FontWeight="Medium" Foreground="DimGray" Margin="0,0,10,8"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedDiffItem.FolderName}" TextWrapping="Wrap" Margin="0,0,0,8"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="变更类型：" FontWeight="Medium" Foreground="DimGray" Margin="0,0,10,8"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedDiffItem.ChangeType}" TextWrapping="Wrap" Margin="0,0,0,8"/>
                                        </Grid>

                                        <Separator Margin="0,0,0,15"/>

                                        <!-- 字段变更详情 -->
                                        <TextBlock Text="字段变更" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>

                                        <!-- 名称变更 -->
                                        <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="3" Padding="10" Margin="0,0,0,10">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedDiffItem.NameChange.HasChange}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <StackPanel>
                                                <TextBlock Text="名称 (Name)" FontWeight="SemiBold" Foreground="#673AB7" Margin="0,0,0,8"/>
                                                <TextBlock Text="旧值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.NameChange.OldValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#FFF3E0" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,8" Padding="5"/>
                                                <TextBlock Text="新值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.NameChange.NewValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#E8F5E9" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,0" Padding="5"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- 描述变更 -->
                                        <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="3" Padding="10" Margin="0,0,0,10">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedDiffItem.DescriptionChange.HasChange}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <StackPanel>
                                                <TextBlock Text="描述 (Description)" FontWeight="SemiBold" Foreground="#673AB7" Margin="0,0,0,8"/>
                                                <TextBlock Text="旧值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.DescriptionChange.OldValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#FFF3E0" BorderThickness="0"
                                                        TextWrapping="Wrap" AcceptsReturn="True" Height="80"
                                                        VerticalScrollBarVisibility="Auto" Margin="0,2,0,8" Padding="5"/>
                                                <TextBlock Text="新值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.DescriptionChange.NewValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#E8F5E9" BorderThickness="0"
                                                        TextWrapping="Wrap" AcceptsReturn="True" Height="80"
                                                        VerticalScrollBarVisibility="Auto" Margin="0,2,0,0" Padding="5"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- 作者变更 -->
                                        <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="3" Padding="10" Margin="0,0,0,10">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedDiffItem.AuthorChange.HasChange}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <StackPanel>
                                                <TextBlock Text="作者 (Author)" FontWeight="SemiBold" Foreground="#673AB7" Margin="0,0,0,8"/>
                                                <TextBlock Text="旧值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.AuthorChange.OldValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#FFF3E0" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,8" Padding="5"/>
                                                <TextBlock Text="新值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.AuthorChange.NewValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#E8F5E9" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,0" Padding="5"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- 版本变更 -->
                                        <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="3" Padding="10" Margin="0,0,0,10">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedDiffItem.VersionChange.HasChange}" Value="True">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <StackPanel>
                                                <TextBlock Text="版本 (Version)" FontWeight="SemiBold" Foreground="#673AB7" Margin="0,0,0,8"/>
                                                <TextBlock Text="旧值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.VersionChange.OldValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#FFF3E0" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,8" Padding="5"/>
                                                <TextBlock Text="新值：" FontWeight="Medium" Foreground="DimGray" FontSize="11"/>
                                                <TextBox Text="{Binding SelectedDiffItem.VersionChange.NewValue, Mode=OneWay}"
                                                        IsReadOnly="True" Background="#E8F5E9" BorderThickness="0"
                                                        TextWrapping="Wrap" Margin="0,2,0,0" Padding="5"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
